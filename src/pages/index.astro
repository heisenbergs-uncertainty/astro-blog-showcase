---
import Layout from "../layouts/Layout.astro";
import Hero from "../components/Hero.astro";
import Starfield from "../components/Starfield.astro";
import ProjectCard from "../components/ProjectCard.astro";
import BlogCard from "../components/BlogCard.astro";
import { getCollection } from "astro:content";

// Latest 3 Posts
const latestPosts = (await getCollection("blog"))
    .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf())
    .slice(0, 3);

// Featured Projects (Tagged 'Favorite')
const featuredProjects = (await getCollection("projects"))
    .filter((project) => project.data.tags?.includes("Favorite"))
    .sort((a, b) => b.data.pubDate.valueOf() - a.data.pubDate.valueOf());
---

<Layout title="DevPortfolio | Software Engineer">
    <Starfield />
    <Hero />

    <!-- Brief About / Skills Section -->
    <section class="py-16 md:py-24">
        <div class="max-w-7xl mx-auto px-4 md:px-8">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div>
                    <div
                        class="glass-panel h-full p-8 rounded-xl border border-[var(--color-glass-border)]"
                    >
                        <div>
                            <h3
                                class="text-xl font-bold text-[var(--color-primary)] mb-2"
                            >
                                Engineering
                            </h3>
                            <p class="text-gray-400 leading-relaxed">
                                Full-stack development with a focus on
                                performance and scalability.
                            </p>
                        </div>
                    </div>
                </div>
                <div>
                    <div
                        class="glass-panel h-full p-8 rounded-xl border border-[var(--color-glass-border)]"
                    >
                        <div>
                            <h3
                                class="text-xl font-bold text-[var(--color-warning)] mb-2"
                            >
                                3D Modeling
                            </h3>
                            <p class="text-gray-400 leading-relaxed">
                                Creating immersive 3D assets and environments
                                for web and games.
                            </p>
                        </div>
                    </div>
                </div>
                <div>
                    <div
                        class="glass-panel h-full p-8 rounded-xl border border-[var(--color-glass-border)]"
                    >
                        <div>
                            <h3
                                class="text-xl font-bold text-[var(--color-danger)] mb-2"
                            >
                                Creative Tech
                            </h3>
                            <p class="text-gray-400 leading-relaxed">
                                Exploring the intersection of art and technology
                                through code.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Featured Projects -->
    {
        featuredProjects.length > 0 && (
            <section class="py-16" id="featured-projects">
                <div class="max-w-7xl mx-auto px-4 md:px-8">
                    <div class="flex items-center justify-between mb-10">
                        <h2 class="text-3xl font-bold text-white">
                            Featured Projects
                        </h2>
                        <a
                            href="/portfolio"
                            class="text-[var(--color-primary)] hover:text-white transition-colors flex items-center group"
                        >
                            View All Projects{" "}
                            <span class="group-hover:translate-x-1 transition-transform ml-1">
                                →
                            </span>
                        </a>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {featuredProjects.map((project) => (
                            <ProjectCard project={project} />
                        ))}
                    </div>
                </div>
            </section>
        )
    }

    <!-- Latest Posts -->
    {
        latestPosts.length > 0 && (
            <section class="py-16" id="latest-posts">
                <div class="max-w-7xl mx-auto px-4 md:px-8">
                    <div class="flex items-center justify-between mb-10">
                        <h2 class="text-3xl font-bold text-white">
                            Latest from the Blog
                        </h2>
                        <a
                            href="/blog"
                            class="text-[var(--color-primary)] hover:text-white transition-colors flex items-center group"
                        >
                            Read More{" "}
                            <span class="group-hover:translate-x-1 transition-transform ml-1">
                                →
                            </span>
                        </a>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">
                        {latestPosts.map((post) => (
                            <BlogCard post={post} />
                        ))}
                    </div>
                </div>
            </section>
        )
    }
</Layout>

<style>
    .h-100 {
        height: 100%;
    }
</style>
